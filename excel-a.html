<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì‹¤ë¬´ ì—‘ì…€/êµ¬ê¸€ì‹œíŠ¸ ì§„ë‹¨ - ê³ ìˆ˜ ì´í˜„ì§€</title>
    <style>
      body {
        font-family: "Pretendard", sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 600px;
        margin: 20px auto;
        padding: 20px;
        background-color: #f5f7fa;
      }
      .card {
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      h2 {
        color: #2c3e50;
        border-bottom: 2px solid #3498db;
        padding-bottom: 10px;
      }
      .section {
        margin-bottom: 25px;
      }
      .section-title {
        font-weight: bold;
        display: block;
        margin-bottom: 10px;
        color: #34495e;
      }
      label {
        display: block;
        margin-bottom: 8px;
        cursor: pointer;
      }
      button {
        background: #3498db;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 6px;
        cursor: pointer;
        width: 100%;
        font-size: 16px;
        font-weight: bold;
      }
      button:hover {
        background: #2980b9;
      }
      #resultArea {
        margin-top: 30px;
        display: none;
        padding-top: 20px;
        border-top: 1px dashed #ccc;
      }
      textarea {
        width: 100%;
        height: 120px;
        font-family: monospace;
        padding: 10px;
        background: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 6px;
        box-sizing: border-box;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h2>ğŸ“Š ì‹¤ë¬´ ì—­ëŸ‰ ì‚¬ì „ ì§„ë‹¨</h2>
      <p>í˜„ì§€ ë‹˜, 1ë¶„ë§Œ íˆ¬ìí•´ ì£¼ì„¸ìš”! ë§ì¶¤ ì»¤ë¦¬í˜ëŸ¼ì„ ì¤€ë¹„í•´ ë“œë¦´ê²Œìš”.</p>

      <form id="diagForm">
        <div class="section">
          <span class="section-title">1. ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë„êµ¬</span>
          <label
            ><input type="radio" name="tool" value="Excel" required /> ì—‘ì…€
            (Excel)</label
          >
          <label
            ><input type="radio" name="tool" value="GoogleSheets" /> êµ¬ê¸€ ì‹œíŠ¸
            (Google Sheets)</label
          >
          <label
            ><input type="radio" name="tool" value="Both" /> ë‘˜ ë‹¤ ë³‘í–‰</label
          >
        </div>

        <div class="section">
          <span class="section-title">2. í˜„ì¬ ê°€ëŠ¥í•œ ì‘ì—… (ëª¨ë‘ ì„ íƒ)</span>
          <label
            ><input type="checkbox" name="skill" value="basic_format" /> ì…€
            ë³‘í•©, í…Œë‘ë¦¬ ë“± ê¸°ë³¸ í¸ì§‘</label
          >
          <label
            ><input type="checkbox" name="skill" value="basic_fn" /> SUM,
            AVERAGE ë“± ê¸°ì´ˆ í•¨ìˆ˜</label
          >
          <label
            ><input type="checkbox" name="skill" value="lookup_fn" /> IF,
            VLOOKUP ë“± ì°¸ì¡° í•¨ìˆ˜</label
          >
          <label
            ><input type="checkbox" name="skill" value="pivot_aware" /> í”¼ë²—
            í…Œì´ë¸” ê°œë… ì´í•´</label
          >
        </div>

        <div class="section">
          <span class="section-title"
            >3. í‰ì†Œ ì—…ë¬´ ìŠ¤íƒ€ì¼ (í•´ë‹¹ë˜ëŠ” ê²ƒ ì„ íƒ)</span
          >
          <label
            ><input type="checkbox" name="habit" value="merge_heavy" /> ë³´ê³ ì„œ
            ê°€ë…ì„±ì„ ìœ„í•œ ì…€ ë³‘í•© ì„ í˜¸</label
          >
          <label
            ><input type="checkbox" name="habit" value="manual_input" />
            í•¨ìˆ˜ë³´ë‹¤ ì§ì ‘ ì…ë ¥/ë³µì‚¬ê°€ í¸í•¨</label
          >
          <label
            ><input type="checkbox" name="habit" value="subtotal_row" /> ë°ì´í„°
            ì¤‘ê°„ì— í•©ê³„ í–‰ì„ ì§ì ‘ ì‚½ì…</label
          >
          <label
            ><input type="checkbox" name="habit" value="color_tag" /> ìƒ‰ìƒìœ¼ë¡œ
            ë°ì´í„°ë¥¼ ë¶„ë¥˜/ê´€ë¦¬</label
          >
        </div>

        <button type="button" onclick="processDiagnosis()">
          ì§„ë‹¨ ì™„ë£Œ ë° ì „ì†¡í•˜ê¸°
        </button>
      </form>

      <div id="resultArea">
        <span class="section-title">ğŸ“‹ ì§„ë‹¨ ê²°ê³¼ ë°ì´í„°</span>
        <p style="font-size: 13px; color: #666; margin-bottom: 10px">
          ì „ì†¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê³ ìˆ˜ë‹˜ì´ ì½”ë“œë¥¼ ìš”ì²­í•˜ì‹œë©´ ì•„ë˜ ë²„íŠ¼ì„
          ëˆŒëŸ¬ì£¼ì„¸ìš”.
        </p>
        <textarea id="jsonOutput" readonly></textarea>

        <button
          type="button"
          onclick="copyToClipboard()"
          style="background: #2ecc71; margin-top: 10px"
        >
          ê²°ê³¼ ì½”ë“œ ì§ì ‘ ë³µì‚¬í•˜ê¸°
        </button>
      </div>
    </div>

    <script>
      function processDiagnosis() {
        const form = document.getElementById("diagForm");

        // í•„ìˆ˜ í•­ëª© ì²´í¬ (Radio ë²„íŠ¼)
        if (!form.tool.value) {
          alert("1ë²ˆ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë„êµ¬ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.");
          return;
        }

        const formData = new FormData(form);
        const result = {
          timestamp: new Date().toLocaleString(),
          tool: formData.get("tool"),
          skills: formData.getAll("skill"),
          habits: formData.getAll("habit"),
        };

        const jsonStr = JSON.stringify(result, null, 2);
        const GAS_URL =
          "https://script.google.com/macros/s/AKfycbwGdVk4tyh84uoyskm6yZUIAiFVSBmZ2ASVgUSgXdi3yttbFzXbmfu6Fg_vlM78N6ux/exec";

        // í”Œëœ A: êµ¬ê¸€ ì‹œíŠ¸ ì „ì†¡
        fetch(GAS_URL, {
          method: "POST",
          mode: "no-cors",
          body: JSON.stringify(result),
        })
          .then(() => {
            alert(
              "ì§„ë‹¨ ê²°ê³¼ê°€ ê³ ìˆ˜ì—ê²Œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤! ì ì‹œ í›„ ìƒë‹´ì„ ì‹œì‘í•©ë‹ˆë‹¤."
            );
          })
          .catch((err) => {
            console.error("ì „ì†¡ ì˜¤ë¥˜:", err);
            alert(
              "ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í•˜ë‹¨ì˜ ì½”ë“œë¥¼ ë³µì‚¬í•´ì„œ ì „ë‹¬í•´ ì£¼ì„¸ìš”."
            );
          });

        // í”Œëœ B: ê²°ê³¼ ë…¸ì¶œ ë° ìŠ¤í¬ë¡¤
        const output = document.getElementById("jsonOutput");
        output.value = jsonStr;
        const resultArea = document.getElementById("resultArea");
        resultArea.style.display = "block";
        resultArea.scrollIntoView({ behavior: "smooth" });
      }

      function copyToClipboard() {
        const output = document.getElementById("jsonOutput");
        output.select();
        try {
          document.execCommand("copy");
          alert("ê²°ê³¼ ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì±„íŒ…ì°½ì— ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”!");
        } catch (err) {
          alert("ë³µì‚¬ ì‹¤íŒ¨! ì§ì ‘ ë“œë˜ê·¸í•´ì„œ ë³µì‚¬í•´ ì£¼ì„¸ìš”.");
        }
      }
    </script>
  </body>
</html>
